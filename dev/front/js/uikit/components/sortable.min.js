/*! UIkit 3.16.15 | https://www.getuikit.com | (c) 2014 - 2023 YOOtheme | MIT License */(function(e,g){typeof exports=="object"&&typeof module<"u"?module.exports=g(require("uikit-util")):typeof define=="function"&&define.amd?define("uikitsortable",["uikit-util"],g):(e=typeof globalThis<"u"?globalThis:e||self,e.UIkitSortable=g(e.UIkit.util))})(this,function(e){"use strict";function g(n){return y(e.observeResize,n,"resize")}function N(n){return y(e.observeMutation,n)}function y(n,s,o){return{observe:n,handler(){this.$emit(o)},...s}}N({options:{childList:!0,attributes:!0,attributeFilter:["style"]}}),g({target:({$el:n})=>[n,...e.children(n)]});function C(n){return T(n,"top","bottom")}function z(n){const s=[];for(const o of n){const t=T(o,"left","right");for(let a=0;a<t.length;a++)s[a]=s[a]?s[a].concat(t[a]):t[a]}return e.isRtl?s.reverse():s}function T(n,s,o){const t=[[]];for(const a of n){if(!e.isVisible(a))continue;let c=u(a);for(let r=t.length-1;r>=0;r--){const h=t[r];if(!h[0]){h.push(a);break}let d;if(h[0].offsetParent===a.offsetParent?d=u(h[0]):(c=u(a,!0),d=u(h[0],!0)),c[s]>=d[o]-1&&c[s]!==d[s]){t.push([a]);break}if(c[o]-1>d[s]||c[s]===d[s]){h.push(a);break}if(r===0){t.unshift([a]);break}}}return t}function u(n,s=!1){let{offsetTop:o,offsetLeft:t,offsetHeight:a,offsetWidth:c}=n;return s&&([o,t]=e.offsetPosition(n)),{top:o,left:t,bottom:o+a,right:t+c}}const v="uk-transition-leave",w="uk-transition-enter";function P(n,s,o,t=0){const a=b(s,!0),c={opacity:1},r={opacity:0},h=p=>()=>a===b(s)?p():Promise.reject(),d=h(async()=>{e.addClass(s,v),await Promise.all(x(s).map((p,l)=>new Promise(f=>setTimeout(()=>e.Transition.start(p,r,o/2,"ease").then(f),l*t)))),e.removeClass(s,v)}),i=h(async()=>{const p=e.height(s);e.addClass(s,w),n(),e.css(e.children(s),{opacity:0}),await A();const l=e.children(s),f=e.height(s);e.css(s,"alignContent","flex-start"),e.height(s,p);const m=x(s);e.css(l,r);const R=m.map(async(X,Y)=>{await H(Y*t),await e.Transition.start(X,c,o/2,"ease")});p!==f&&R.push(e.Transition.start(s,{height:f},o/2+m.length*t,"ease")),await Promise.all(R).then(()=>{e.removeClass(s,w),a===b(s)&&(e.css(s,{height:"",alignContent:""}),e.css(l,{opacity:""}),delete s.dataset.transition)})});return e.hasClass(s,v)?S(s).then(i):e.hasClass(s,w)?S(s).then(d).then(i):d().then(i)}function b(n,s){return s&&(n.dataset.transition=1+b(n)),e.toNumber(n.dataset.transition)||0}function S(n){return Promise.all(e.children(n).filter(e.Transition.inProgress).map(s=>new Promise(o=>e.once(s,"transitionend transitioncanceled",o))))}function x(n){return C(e.children(n)).reduce((s,o)=>s.concat(e.sortBy(o.filter(t=>e.isInView(t)),"offsetLeft")),[])}function A(){return new Promise(n=>requestAnimationFrame(n))}function H(n){return new Promise(s=>setTimeout(s,n))}async function L(n,s,o){await D();let t=e.children(s);const a=t.map(f=>I(f,!0)),c={...e.css(s,["height","padding"]),display:"block"};await Promise.all(t.concat(s).map(e.Transition.cancel)),n(),t=t.concat(e.children(s).filter(f=>!e.includes(t,f))),await Promise.resolve(),e.fastdom.flush();const r=e.attr(s,"style"),h=e.css(s,["height","padding"]),[d,i]=M(s,t,a),p=t.map(f=>({style:e.attr(f,"style")}));t.forEach((f,m)=>i[m]&&e.css(f,i[m])),e.css(s,c),e.trigger(s,"scroll"),e.fastdom.flush(),await D();const l=t.map((f,m)=>e.parent(f)===s&&e.Transition.start(f,d[m],o,"ease")).concat(e.Transition.start(s,h,o,"ease"));try{await Promise.all(l),t.forEach((f,m)=>{e.attr(f,p[m]),e.parent(f)===s&&e.css(f,"display",d[m].opacity===0?"none":"")}),e.attr(s,"style",r)}catch{e.attr(t,"style",""),V(s,c)}}function I(n,s){const o=e.css(n,"zIndex");return e.isVisible(n)?{display:"",opacity:s?e.css(n,"opacity"):"0",pointerEvents:"none",position:"absolute",zIndex:o==="auto"?e.index(n):o,...$(n)}:!1}function M(n,s,o){const t=s.map((c,r)=>e.parent(c)&&r in o?o[r]?e.isVisible(c)?$(c):{opacity:0}:{opacity:e.isVisible(c)?1:0}:!1),a=t.map((c,r)=>{const h=e.parent(s[r])===n&&(o[r]||I(s[r]));if(!h)return!1;if(!c)delete h.opacity;else if(!("opacity"in c)){const{opacity:d}=h;d%1?c.opacity=1:delete h.opacity}return h});return[t,a]}function V(n,s){for(const o in s)e.css(n,o,"")}function $(n){const{height:s,width:o}=e.offset(n);return{height:s,width:o,transform:"",...e.position(n),...e.css(n,["marginTop","marginLeft"])}}function D(){return new Promise(n=>requestAnimationFrame(n))}var j={props:{duration:Number,animation:Boolean},data:{duration:150,animation:"slide"},methods:{animate(n,s=this.$el){const o=this.animation;return(o==="fade"?P:o==="delayed-fade"?(...a)=>P(...a,40):o?L:()=>(n(),Promise.resolve()))(n,s,this.duration).catch(e.noop)}}},q={connected(){e.addClass(this.$el,this.$options.id)}},E={mixins:[q,j],props:{group:String,threshold:Number,clsItem:String,clsPlaceholder:String,clsDrag:String,clsDragState:String,clsBase:String,clsNoDrag:String,clsEmpty:String,clsCustom:String,handle:String},data:{group:!1,threshold:5,clsItem:"uk-sortable-item",clsPlaceholder:"uk-sortable-placeholder",clsDrag:"uk-sortable-drag",clsDragState:"uk-drag",clsBase:"uk-sortable",clsNoDrag:"uk-sortable-nodrag",clsEmpty:"uk-sortable-empty",clsCustom:"",handle:!1,pos:{}},created(){for(const n of["init","start","move","end"]){const s=this[n];this[n]=o=>{e.assign(this.pos,e.getEventPos(o)),s(o)}}},events:{name:e.pointerDown,passive:!1,handler:"init"},computed:{target(){return(this.$el.tBodies||[this.$el])[0]},items(){return e.children(this.target)},isEmpty(){return e.isEmpty(this.items)},handles({handle:n},s){return n?e.$$(n,s):this.items}},watch:{isEmpty(n){e.toggleClass(this.target,this.clsEmpty,n)},handles(n,s){e.css(s,{touchAction:"",userSelect:""}),e.css(n,{touchAction:e.hasTouch?"none":"",userSelect:"none"})}},update:{write(n){if(!this.drag||!e.parent(this.placeholder))return;const{pos:{x:s,y:o},origin:{offsetTop:t,offsetLeft:a},placeholder:c}=this;e.css(this.drag,{top:o-t,left:s-a});const r=this.getSortable(document.elementFromPoint(s,o));if(!r)return;const{items:h}=r;if(h.some(e.Transition.inProgress))return;const d=J(h,{x:s,y:o});if(h.length&&(!d||d===c))return;const i=this.getSortable(c),p=K(r.target,d,c,s,o,r===i&&n.moved!==d);p!==!1&&(p&&c===p||(r!==i?(i.remove(c),n.moved=d):delete n.moved,r.insert(c,p),this.touched.add(r)))},events:["move"]},methods:{init(n){const{target:s,button:o,defaultPrevented:t}=n,[a]=this.items.filter(c=>e.within(s,c));!a||t||o>0||e.isInput(s)||e.within(s,`.${this.clsNoDrag}`)||this.handle&&!e.within(s,this.handle)||(n.preventDefault(),this.touched=new Set([this]),this.placeholder=a,this.origin={target:s,index:e.index(a),...this.pos},e.on(document,e.pointerMove,this.move),e.on(document,e.pointerUp,this.end),this.threshold||this.start(n))},start(n){this.drag=G(this.$container,this.placeholder);const{left:s,top:o}=this.placeholder.getBoundingClientRect();e.assign(this.origin,{offsetLeft:this.pos.x-s,offsetTop:this.pos.y-o}),e.addClass(this.drag,this.clsDrag,this.clsCustom),e.addClass(this.placeholder,this.clsPlaceholder),e.addClass(this.items,this.clsItem),e.addClass(document.documentElement,this.clsDragState),e.trigger(this.$el,"start",[this,this.placeholder]),W(this.pos),this.move(n)},move(n){this.drag?this.$emit("move"):(Math.abs(this.pos.x-this.origin.x)>this.threshold||Math.abs(this.pos.y-this.origin.y)>this.threshold)&&this.start(n)},end(){if(e.off(document,e.pointerMove,this.move),e.off(document,e.pointerUp,this.end),!this.drag)return;O();const n=this.getSortable(this.placeholder);this===n?this.origin.index!==e.index(this.placeholder)&&e.trigger(this.$el,"moved",[this,this.placeholder]):(e.trigger(n.$el,"added",[n,this.placeholder]),e.trigger(this.$el,"removed",[this,this.placeholder])),e.trigger(this.$el,"stop",[this,this.placeholder]),e.remove(this.drag),this.drag=null;for(const{clsPlaceholder:s,clsItem:o}of this.touched)for(const t of this.touched)e.removeClass(t.items,s,o);this.touched=null,e.removeClass(document.documentElement,this.clsDragState)},insert(n,s){e.addClass(this.items,this.clsItem);const o=()=>s?e.before(s,n):e.append(this.target,n);this.animate(o)},remove(n){e.within(n,this.target)&&this.animate(()=>e.remove(n))},getSortable(n){do{const s=this.$getComponent(n,"sortable");if(s&&(s===this||this.group!==!1&&s.group===this.group))return s}while(n=e.parent(n))}}};let F;function W(n){let s=Date.now();F=setInterval(()=>{let{x:o,y:t}=n;t+=document.scrollingElement.scrollTop;const a=(Date.now()-s)*.3;s=Date.now(),e.scrollParents(document.elementFromPoint(o,n.y)).reverse().some(c=>{let{scrollTop:r,scrollHeight:h}=c;const{top:d,bottom:i,height:p}=e.offsetViewport(c);if(d<t&&d+35>t)r-=a;else if(i>t&&i-35<t)r+=a;else return;if(r>0&&r<h-p)return c.scrollTop=r,!0})},15)}function O(){clearInterval(F)}function G(n,s){let o;if(e.isTag(s,"li","tr")){o=e.$("<div>"),e.append(o,s.cloneNode(!0).children);for(const t of s.getAttributeNames())e.attr(o,t,s.getAttribute(t))}else o=s.cloneNode(!0);return e.append(n,o),e.css(o,"margin","0","important"),e.css(o,{boxSizing:"border-box",width:s.offsetWidth,height:s.offsetHeight,padding:e.css(s,"padding")}),e.height(o.firstElementChild,e.height(s.firstElementChild)),o}function J(n,s){return n[e.findIndex(n,o=>e.pointInRect(s,o.getBoundingClientRect()))]}function K(n,s,o,t,a,c){if(!e.children(n).length)return;const r=s.getBoundingClientRect();if(!c)return Q(n,o)||a<r.top+r.height/2?s:s.nextElementSibling;const h=o.getBoundingClientRect(),d=B([r.top,r.bottom],[h.top,h.bottom]),[i,p,l,f]=d?[t,"width","left","right"]:[a,"height","top","bottom"],m=h[p]<r[p]?r[p]-h[p]:0;return h[l]<r[l]?m&&i<r[l]+m?!1:s.nextElementSibling:m&&i>r[f]-m?!1:s}function Q(n,s){const o=e.children(n).length===1;o&&e.append(n,s);const t=e.children(n),a=t.some((c,r)=>{const h=c.getBoundingClientRect();return t.slice(r+1).some(d=>{const i=d.getBoundingClientRect();return!B([h.left,h.right],[i.left,i.right])})});return o&&e.remove(s),a}function B(n,s){return n[1]>s[0]&&s[1]>n[0]}return typeof window<"u"&&window.UIkit&&window.UIkit.component("sortable",E),E});
